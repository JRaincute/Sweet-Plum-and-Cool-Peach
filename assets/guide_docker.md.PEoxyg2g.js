import{_ as e,o as a,c as o,R as s}from"./chunks/framework.rTMGYeCn.js";const k=JSON.parse('{"title":"Docker部署","description":"","frontmatter":{},"headers":[],"relativePath":"guide/docker.md","filePath":"guide/docker.md"}'),t={name:"guide/docker.md"},c=s('<h1 id="docker部署" tabindex="-1">Docker部署 <a class="header-anchor" href="#docker部署" aria-label="Permalink to &quot;Docker部署&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>在使用docker安装之前，需要安装好docker,docker-compose</p></div><h2 id="后端部署" tabindex="-1">后端部署 <a class="header-anchor" href="#后端部署" aria-label="Permalink to &quot;后端部署&quot;">​</a></h2><h3 id="_1-配置后端文件" tabindex="-1">1.配置后端文件 <a class="header-anchor" href="#_1-配置后端文件" aria-label="Permalink to &quot;1.配置后端文件&quot;">​</a></h3><p>打开 <code>data/config/application.yml</code>文件，根据其中的注释修改配置文件并保存</p><h3 id="_2-构建" tabindex="-1">2.构建 <a class="header-anchor" href="#_2-构建" aria-label="Permalink to &quot;2.构建&quot;">​</a></h3><p>执行以下命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker-compose build</span></span></code></pre></div><h3 id="_3-启动后端" tabindex="-1">3.启动后端 <a class="header-anchor" href="#_3-启动后端" aria-label="Permalink to &quot;3.启动后端&quot;">​</a></h3><p>执行以下命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker-compose up -d</span></span></code></pre></div><p>如需停止项目执行</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker-compose stop</span></span></code></pre></div><h2 id="前端部署" tabindex="-1">前端部署 <a class="header-anchor" href="#前端部署" aria-label="Permalink to &quot;前端部署&quot;">​</a></h2><div class="warning custom-block"><p class="custom-block-title">提示</p><p>目前的部署方式不建议使用docker部署前端，建议直接跳转到<a href="/Sweet-Plum-and-Cool-Peach/guide/domain.html#未部署前端">域名配置</a>完成前端的部署</p></div><h3 id="_1-配置后端文件-1" tabindex="-1">1.配置后端文件 <a class="header-anchor" href="#_1-配置后端文件-1" aria-label="Permalink to &quot;1.配置后端文件&quot;">​</a></h3><p>打开 <code>web\\utils\\src\\global-config.ts</code>文件，修改<code>domain</code>为后端域名</p><p><strong>注意：仅域名不包含http、斜线、反斜线等内容，没有域名可以使用可以为ip:端口</strong></p><h3 id="_2-构建-1" tabindex="-1">2.构建 <a class="header-anchor" href="#_2-构建-1" aria-label="Permalink to &quot;2.构建&quot;">​</a></h3><p>docker构建提供了两种构建方式，docker打包+部署内包含了前端项目的构建，但是对服务器性能要求较高， docker仅部署对服务器要求相对低，但需要手动打包前端</p><h4 id="_2-1-使用docker打包-部署" tabindex="-1">2.1 使用docker打包+部署 <a class="header-anchor" href="#_2-1-使用docker打包-部署" aria-label="Permalink to &quot;2.1 使用docker打包+部署&quot;">​</a></h4><p>进入web目录执行以下命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker build -f Dockerfile-build -t &quot;leaf-web&quot; .</span></span></code></pre></div><h4 id="_2-2-使用docker仅部署" tabindex="-1">2.2 使用docker仅部署 <a class="header-anchor" href="#_2-2-使用docker仅部署" aria-label="Permalink to &quot;2.2 使用docker仅部署&quot;">​</a></h4><ol><li>在构建之前需要先对前端项目进行打包，首先要先安装nodejs和pnpm，然后进入<code>web</code>目录，执行</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>pnpm i</span></span></code></pre></div><ol start="2"><li>在<code>web</code>目录中创建<code>dist</code>文件夹</li><li>进入<code>web\\packages\\web-client</code>执行命令<code>pnpm run build</code> 将产生的<code>web</code>文件夹复制到<code>dist</code></li><li>进入<code>web\\packages\\manage-client</code>执行命令<code>pnpm run build</code> 将产生的<code>manage</code>文件夹复制到<code>dist</code></li><li>进入<code>web\\packages\\mobile-client</code>执行命令<code>pnpm run build</code> 将产生的<code>mobile</code>文件夹复制到<code>dist</code></li><li>在<code>web</code>目录下执行以下命令</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker build -t &quot;leaf-web&quot; .</span></span></code></pre></div><h3 id="_3-启动前端" tabindex="-1">3.启动前端 <a class="header-anchor" href="#_3-启动前端" aria-label="Permalink to &quot;3.启动前端&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker run -itd --name leafWeb -p 9090:9090 &quot;leaf-web&quot;</span></span></code></pre></div><p>如需停止项目执行</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker stop leafWeb</span></span></code></pre></div>',32),i=[c];function d(l,p,n,r,h,u){return a(),o("div",null,i)}const g=e(t,[["render",d]]);export{k as __pageData,g as default};
